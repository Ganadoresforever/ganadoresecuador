<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Reserva ‚Äì Paso 2 de 5</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Red+Hat+Display:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#f3f4f6;
      --card:#fff;
      --text:#111827;
      --muted:#6b7280;
      --brand:#d61f26; /* rojo Avianca */
      --btn:#585b63;
      --radius:16px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:"Red Hat Display",system-ui,Segoe UI,Roboto,Arial,sans-serif;
      color:var(--text);
      background:var(--bg);
    }

    /* ====== HEADER ====== */
    .booking-header{
      position:sticky; top:0; z-index:50;
      background:#0f1115;
      color:#fff;
      padding:10px 14px;
    }
    .booking-row{
      display:flex; gap:10px; align-items:center; justify-content:space-between; flex-wrap:wrap;
    }
    .brand-minilogo{
      display:flex; align-items:center; gap:10px; min-width:0;
    }
    .route{
      display:flex; flex-direction:column; min-width:0;
    }
    .route-main{
      font-weight:700; letter-spacing:.3px;
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    }
    .route-sub{
      font-size:12px; color:#d1d5db; line-height:1.2;
      display:flex; align-items:center; gap:6px; white-space:nowrap;
    }
    .step-price{
      margin-left:auto;
      display:flex; align-items:center; gap:12px; flex-wrap:wrap;
    }
    .step{
      font-weight:600; font-size:13px; padding:4px 10px; border-radius:999px; background:#1f2937;
    }
    .price-pill{
      font-weight:700; padding:6px 12px; border-radius:999px; background:#111827;
    }

    /* ====== LAYOUT ====== */
    .container{max-width:980px; margin:14px auto; padding:0 14px;}
    .card{background:var(--card); border-radius:var(--radius); box-shadow:0 1px 3px rgba(0,0,0,.06); padding:18px;}

    h2{margin:0 0 12px 0; font-size:20px}
    .field{margin-bottom:12px}
    .input, .checkbox{
      width:100%; border:1px solid #e5e7eb; border-radius:12px; padding:12px 14px; font-size:15px; background:#fff;
    }
    .row-actions{display:flex; gap:10px; flex-wrap:wrap}
    .btn{
      appearance:none; border:0; border-radius:12px; background:var(--btn);
      color:#fff; padding:12px 16px; font-weight:700; cursor:pointer;
    }
    .btn[disabled]{opacity:.6; cursor:not-allowed}

    /* Quitar ‚Äúsubmit‚Äù gen√©rico si existe en el HTML heredado */
    form button[type="submit"]. ghost-remove,
    form > button[type="submit"]:not(.btn){ display:none !important; }

    /* ====== RESUMEN ====== */
    .summary{display:grid; gap:10px}
    .summary-line{display:flex; justify-content:space-between; align-items:center; gap:10px}
    .summary-title{font-weight:700}
    .total{font-size:18px; font-weight:800}

    /* ====== RESPONSIVE ====== */
    @media (min-width:640px){
      .route{flex-direction:row; align-items:baseline; gap:10px}
      .route-sub{font-size:13px}
    }
  </style>
</head>
<body>

  <!-- HEADER -->
  <header class="booking-header">
    <div class="booking-row">
      <div class="brand-minilogo">
        <span style="font-weight:800">av</span>
        <div class="route">
          <div class="route-main" id="routeText">UIO ‚Üí GPS</div>
          <div class="route-sub" id="dateText">
            <span aria-hidden="true">üìÖ</span>
            <span>Mar, 17 Sep 2024 ‚Ä¢ 08:45</span>
          </div>
        </div>
      </div>
      <div class="step-price">
        <span class="step" id="stepText">Paso 2 de 5</span>
        <span class="price-pill" id="pricePill">USD 0,00</span>
      </div>
    </div>
  </header>

  <main class="container">
    <!-- DATOS PERSONALES -->
    <section class="card">
      <h2>Datos personales</h2>
      <p style="margin-top:-6px; color:var(--muted); font-size:13px">
        Ingresa nombre y primer apellido exactamente como aparecen en el documento.
      </p>
      <form id="passengerForm">
        <div class="field"><input class="input" placeholder="Nombre" required></div>
        <div class="field"><input class="input" placeholder="Apellido" required></div>
        <div class="field"><label style="display:flex; gap:10px; align-items:center">
          <input type="checkbox"> <span>Tengo n√∫mero de viajero frecuente (opcional)</span>
        </label></div>
        <div class="field"><label style="display:flex; gap:10px; align-items:center">
          <input type="checkbox"> <span>Necesito asistencia especial (opcional)</span>
        </label></div>

        <div class="row-actions">
          <button type="button" class="btn" id="nextPaxBtn">Pr√≥ximo pasajero</button>
        </div>
      </form>
    </section>

    <!-- CONTACTO -->
    <section class="card" style="margin-top:14px">
      <h2>Informaci√≥n de contacto</h2>
      <form id="contactForm">
        <div class="field"><input type="email" class="input" placeholder="Correo" required></div>
        <div class="field"><input type="tel" class="input" placeholder="N√∫mero de tel√©fono" required></div>
        <div class="field"><label style="display:flex; gap:10px; align-items:center">
          <input type="checkbox"> <span>Acepto promociones y novedades (opcional)</span>
        </label></div>
        <div class="row-actions">
          <button type="button" class="btn" id="continueBtn">Continuar a pagar</button>
        </div>
        <!-- Si por herencia exist√≠a un bot√≥n submit, lo ocultamos con CSS arriba -->
        <button type="submit" class="ghost-remove">submit</button>
      </form>
    </section>

    <!-- RESUMEN -->
    <aside class="card" style="margin-top:14px">
      <div class="summary">
        <div class="summary-line">
          <div>
            <div class="summary-title">Resumen del viaje</div>
            <div id="summaryRoute" style="font-weight:700">UIO ‚Üí GPS</div>
          </div>
          <div class="total" id="summaryTotal">USD 0,00</div>
        </div>
        <div class="summary-line" style="color:var(--muted); font-size:13px">
          <span id="summaryDate">Mar, 17 Sep 2024 ‚Ä¢ 08:45</span>
          <span>Total de tu reserva</span>
        </div>
      </div>
    </aside>

    <p style="text-align:center; color:#9ca3af; font-size:13px; margin:22px 0 10px">¬© Avianca S.A 2024</p>
  </main>

  <script>
    /* ==========
      TOTAL DIN√ÅMICO
      - 1) Busca precios en elementos seleccionados con data-price
           ej: <input type="radio" name="vuelo" data-price="120.50" checked>
      - 2) Si no encuentra, usa localStorage:
           selectedOutboundPrice, selectedInboundPrice, fees (n√∫meros)
    ========== */

    function readPriceFromDOM() {
      const chosen = [
        ...document.querySelectorAll('[data-price][aria-checked="true"], [data-price]:checked')
      ];
      if (chosen.length) {
        return chosen.reduce((acc, el) => acc + parseFloat(el.getAttribute('data-price') || 0), 0);
      }
      return null;
    }

    function readPriceFromStorage() {
      const o = parseFloat(localStorage.getItem('selectedOutboundPrice') || '0');
      const i = parseFloat(localStorage.getItem('selectedInboundPrice') || '0');
      const f = parseFloat(localStorage.getItem('fees') || '0');
      const sum = o + i + f;
      return isFinite(sum) ? sum : 0;
    }

    function money(n){ 
      try {
        return new Intl.NumberFormat('es-CO', {style:'currency', currency:'USD', minimumFractionDigits:2}).format(n).replace(/\s/g,' ');
      } catch { 
        return 'USD ' + (n||0).toFixed(2);
      }
    }

    function setTotal(amount){
      const pill = document.getElementById('pricePill');
      const sum  = document.getElementById('summaryTotal');
      const txt  = money(amount).replace('US$', 'USD ');
      if (pill) pill.textContent = txt;
      if (sum)  sum.textContent  = txt;
    }

    function refreshTotal(){
      const dom = readPriceFromDOM();
      const total = dom !== null ? dom : readPriceFromStorage();
      setTotal(total || 0);
    }

    // Ruta y fecha: si vienen de storage, √∫salas
    (function hydrateHeader(){
      const route = localStorage.getItem('routeText') || 'UIO ‚Üí GPS';
      const date  = localStorage.getItem('routeDate') || 'Mar, 17 Sep 2024 ‚Ä¢ 08:45';
      const routeEls = [document.getElementById('routeText'), document.getElementById('summaryRoute')];
      routeEls.forEach(el => el && (el.textContent = route));
      const dateEls  = [document.getElementById('dateText')?.lastElementChild, document.getElementById('summaryDate')];
      dateEls.forEach(el => el && (el.textContent = date));
    })();

    // Recalcular al cargar y cuando cambien selecciones
    refreshTotal();
    document.addEventListener('change', (e)=>{
      if (e.target && e.target.hasAttribute('data-price')) refreshTotal();
    });
  </script>
</body>
</html>
